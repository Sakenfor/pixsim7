{
  "version": "2.0",
  "description": "PixSim7 service configuration for dynamic discovery",

  "discovery": {
    "enabled": true,
    "timeout": 2,
    "auto_refresh_interval": 10
  },

  "backend_services": [
    {
      "id": "main-api",
      "name": "Main Backend API",
      "description": "Core API handling game, users, assets, dialogue, and actions",
      "base_url_env": "BACKEND_BASE_URL",
      "port_env": "BACKEND_PORT",
      "default_port": 8000,
      "ports": [
        {
          "name": "Launcher API",
          "env": "LAUNCHER_PORT",
          "default_port": 8100
        },
        {
          "name": "Game Service",
          "env": "GAME_SERVICE_PORT",
          "default_port": 8050
        }
      ],
      "info_endpoint": "/dev/info",
      "health_endpoint": "/health",
      "docs_endpoint": "/docs",
      "openapi_endpoint": "/openapi.json",
      "openapi_types_path": "packages/shared/types/src/openapi.generated.ts",
      "auto_start": true,
      "depends_on": ["db"],
      "enabled": true,
      "type": "python",
      "module": "pixsim7.backend.main.main:app",
      "tags": ["core", "api", "game"]
    },
    {
      "id": "generation-api",
      "name": "Generation API",
      "description": "Lightweight API for generation + chrome extension + automation (excludes game engine). Perfect for development when you don't need NPCs, dialogue, worlds, etc.",
      "base_url_env": "GENERATION_BASE_URL",
      "port_env": "GENERATION_API_PORT",
      "default_port": 8001,
      "ports": [
        {
          "name": "Generation API",
          "env": "GENERATION_API_PORT",
          "default_port": 8001
        }
      ],
      "info_endpoint": "/dev/info",
      "health_endpoint": "/health",
      "docs_endpoint": "/docs",
      "openapi_endpoint": "/openapi.json",
      "openapi_types_path": "packages/shared/types/src/openapi.generated.ts",
      "auto_start": false,
      "depends_on": ["db"],
      "enabled": true,
      "type": "python",
      "module": "pixsim7.backend.generation.main:app",
      "tags": ["api", "generation", "ai", "microservice", "chrome-extension", "automation", "lightweight"],
      "provides": ["generations", "prompts", "providers", "analytics", "auth", "accounts", "automation"]
    }
  ],

  "frontend_services": [
    {
      "id": "admin",
      "name": "Admin Panel",
      "description": "SvelteKit admin interface",
      "base_url_env": "ADMIN_BASE_URL",
      "port_env": "ADMIN_PORT",
      "default_port": 5174,
      "ports": [
        {
          "name": "Admin",
          "env": "ADMIN_PORT",
          "default_port": 5174
        }
      ],
      "directory": "apps/main",
      "command": "npm",
      "args": ["run", "dev"],
      "env_overrides": {
        "VITE_ADMIN_PORT": "$PORT",
        "VITE_BACKEND_URL": "$BACKEND_BASE_URL"
      },
      "auto_start": false,
      "enabled": true,
      "type": "npm"
    },
    {
      "id": "frontend",
      "name": "Main Frontend",
      "description": "React main application",
      "base_url_env": "FRONTEND_BASE_URL",
      "port_env": "FRONTEND_PORT",
      "default_port": 5173,
      "ports": [
        {
          "name": "Frontend",
          "env": "FRONTEND_PORT",
          "default_port": 5173
        }
      ],
      "directory": "apps/main",
      "command": "pnpm",
      "args": ["dev", "--port"],
      "env_overrides": {
        "VITE_GAME_URL": "$GAME_FRONTEND_BASE_URL",
        "VITE_BACKEND_URL": "$BACKEND_BASE_URL"
      },
      "auto_start": false,
      "enabled": true,
      "type": "pnpm"
    },
    {
      "id": "game_frontend",
      "name": "Game Frontend",
      "description": "React game interface",
      "base_url_env": "GAME_FRONTEND_BASE_URL",
      "port_env": "GAME_FRONTEND_PORT",
      "default_port": 5175,
      "ports": [
        {
          "name": "Game Frontend",
          "env": "GAME_FRONTEND_PORT",
          "default_port": 5175
        }
      ],
      "directory": "apps/game",
      "command": "pnpm",
      "args": ["dev", "--port"],
      "env_overrides": {
        "VITE_BACKEND_URL": "$BACKEND_BASE_URL"
      },
      "auto_start": false,
      "enabled": true,
      "type": "pnpm"
    }
  ],

  "infrastructure_services": [
    {
      "id": "db",
      "name": "Databases (Docker)",
      "description": "PostgreSQL and Redis via docker-compose",
      "type": "docker-compose",
      "file": "docker-compose.db-only.yml",
      "auto_start": false,
      "enabled": true,
      "ports": [
        {
          "name": "Postgres",
          "env": "POSTGRES_PORT",
          "default_port": 5434,
          "scan_ports": [5432, 5433, 5434, 5435],
          "connection_template": "postgresql://pixsim:pixsim123@127.0.0.1:{port}/pixsim7"
        },
        {
          "name": "Redis",
          "env": "REDIS_PORT",
          "default_port": 6380,
          "scan_ports": [6379, 6380],
          "connection_template": "redis://localhost:{port}/0"
        }
      ]
    },
    {
      "id": "worker",
      "name": "Worker (ARQ)",
      "description": "Background task worker",
      "type": "python",
      "module": "arq",
      "args": ["pixsim7.backend.main.workers.arq_worker.WorkerSettings"],
      "depends_on": ["db"],
      "auto_start": false,
      "enabled": true
    }
  ],

  "future_services": {
    "_comment": "Examples of services that might be split out later",
    "game-api": {
      "id": "game-api",
      "name": "Game API",
      "description": "Game-specific routes (future split)",
      "port_env": "GAME_API_PORT",
      "default_port": 8002,
      "enabled": false,
      "module": "pixsim7.backend.game.main:app",
      "provides": ["worlds", "sessions", "npcs", "dialogue"],
      "depends_on": ["db"]
    }
  }
}

name: pixsim7
channels:
  - conda-forge
  - defaults
dependencies:
  # Core Python
  - python=3.11
  - pip

  # Web / API
  - fastapi=0.109.0
  - uvicorn=0.27.0
  - pydantic=2.5.3

  # Database / ORM
  - sqlalchemy=2.0.25
  - asyncpg=0.29.0
  - alembic=1.13.1
  - psycopg2=2.9.9
  - aiosqlite=0.19.0  # For in-memory async tests

  # Caching / Queue (redis client only; arq via pip)
  - redis-py=5.0.1

  # HTTP Clients
  - httpx=0.26.0
  - aiohttp=3.9.1

  # Auth & Security
  - python-jose=3.3.0
  - passlib=1.7.4
  - python-multipart=0.0.6

  # Imaging / Hashing
  - pillow=10.2.0
  - imagehash=4.3.1

  # Utilities
  - python-dotenv=1.0.0

  # Dev / Tooling
  - pytest=7.4.4
  - pytest-asyncio=0.23.3
  - black=24.1.1
  - ruff=0.1.15
  - structlog=23.2.0

  # (Optional) If available on conda in future, can migrate from pip
  # - sqlmodel (pip only currently)
  # - pgvector (pip for PostgreSQL extension binding)

  - pip:
    - sqlmodel==0.0.14
    - pgvector==0.2.4
    - pydantic-settings==2.1.0
    - arq==0.25.0
    # Editable provider SDKs (must exist at paths or remove these lines):
    - -e ../pixverse-py
    - -e ../sora-py

# Usage:
#   conda env create -f environment.yml
#   conda activate pixsim7
#   (Optional) set PIXSIM7_USE_PIPELINE=1 for new submission pipeline

# Troubleshooting Pillow build errors (if any):
#   conda update -n base -c defaults conda
#   pip install --upgrade pip setuptools wheel
# Typically pillow from conda-forge avoids source build issues on Windows.